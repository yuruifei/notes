
# 聚类

## 谱聚类
### 步骤
1. 设有n个样本，求两个样本i,j的高斯距离(RBF)S(i,j),得到一个n*n的矩阵，是一个对称阵W。
2. 令 S(i,i) = 0
3. 将W中每行的元素加和，得到n个数，将n个数放到主对角线上其他元素都为0， 得到矩阵D
4. 令 L = D - W 可以证明L是半正定的
5. 求L的特征值，并从小到大排列，lmbda1，lmbda2 ... lmbdan，lmbda1必然为0
6. 我们要将样本聚为k类，则取前k个lambda对应的特征向量，放在一起得到一个n*k的矩阵，
7. 矩阵的第n行代表第n个样本的特征
8. 将这些特征用k-means聚类，得到的结果就是谱聚类的结果

### 原因
#### 直观理解
1. 令one = (1,1,...1) 1*n的行向量，则trans_one 为n*1的全一向量
2. L*trans_one = D*trans_one - W*trans_one,而后面二者相等，所以L*trans_one = 0， 因此，0是L的特诊值，trans_one是L的特征向量
3. 特殊值法，假设样本中前r个可以聚为一类，后n-r个是另一类，则D和W都可以在对角线方向行分为两个矩阵分别为r维和n-r维，将它们认为是更小维度的L，则Lr与Ln-r分别有更小维度的trans_one特征向量。将二者结合起来，发现特征向量正好可以将样本分为两类。

#### 证明思路
图切割
